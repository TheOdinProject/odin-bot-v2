name: Format and Lint
on:
  pull_request:
    paths:
      - '**/*.js'
      - '**/*.json'
      - '**/*.yml'
      - '**/*.yaml'

jobs:
  prettier:
    name: Check formatting
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: tj-actions/changed-files@v46
        id: changed-files
        with:
          files: |
            **/*.js
            **/*.json
            **/*.yml
            **/*.yaml
          separator: ' '
      - uses: creyD/prettier_action@v4.3
        if: steps.changed-files.outputs.all_changed_files
        with:
          dry: True
          prettier_options: --check ${{ steps.changed-files.outputs.all_changed_files }}

  eslint:
    name: Check linting
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: tj-actions/changed-files@v46
        id: changed-files
        with:
          files: |
            **/*.js
          separator: ' '
      - if: steps.changed-files.outputs.all_changed_files
        run: npm install && npm run eslint -- ${{ steps.changed-files.outputs.all_changed_files }}
